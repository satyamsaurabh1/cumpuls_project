{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useParams,useNavigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';import{useSocket}from'../context/SocketContext';import api from'../config/api';import{FiSend,FiArrowLeft,FiMoreVertical,FiUser,FiCheck,FiMessageCircle}from'react-icons/fi';import{format}from'date-fns';import toast from'react-hot-toast';import'./Messages.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Messages=()=>{const{userId}=useParams();const navigate=useNavigate();const{user}=useAuth();const{sendMessage,joinConversation,isOnline,startTyping,stopTyping}=useSocket();const[conversations,setConversations]=useState([]);const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[selectedUser,setSelectedUser]=useState(null);const[loading,setLoading]=useState(true);const[typingUser,setTypingUser]=useState(null);const messagesEndRef=useRef(null);const typingTimeoutRef=useRef(null);useEffect(()=>{fetchConversations();},[]);useEffect(()=>{if(userId){fetchConversation(userId);joinConversation(userId);}},[userId]);useEffect(()=>{scrollToBottom();},[messages]);const fetchConversations=async()=>{try{const response=await api.get('/messages/conversations');setConversations(response.data);}catch(error){toast.error('Failed to load conversations');}finally{setLoading(false);}};const fetchConversation=async otherUserId=>{try{const response=await api.get(\"/messages/\".concat(otherUserId));setMessages(response.data);// Find and set selected user\nif(response.data.length>0){const otherUser=response.data[0].sender._id===user._id?response.data[0].receiver:response.data[0].sender;setSelectedUser(otherUser);}else{// If no messages yet, fetch user details\nconst userResponse=await api.get(\"/users/\".concat(otherUserId));setSelectedUser(userResponse.data);}}catch(error){toast.error('Failed to load conversation');}};const handleSendMessage=e=>{e.preventDefault();if(!newMessage.trim()||!selectedUser)return;sendMessage(selectedUser._id,newMessage);setNewMessage('');stopTyping(selectedUser._id);};const handleTyping=()=>{if(!selectedUser)return;startTyping(selectedUser._id);if(typingTimeoutRef.current){clearTimeout(typingTimeoutRef.current);}typingTimeoutRef.current=setTimeout(()=>{stopTyping(selectedUser._id);},1000);};const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};const formatMessageTime=timestamp=>{const date=new Date(timestamp);const now=new Date();const diffInDays=Math.floor((now-date)/(1000*60*60*24));if(diffInDays===0){return format(date,'hh:mm a');}else if(diffInDays===1){return'Yesterday';}else if(diffInDays<7){return format(date,'EEEE');}else{return format(date,'MMM d, yyyy');}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading messages...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"messages-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"conversations-sidebar \".concat(userId?'hidden-mobile':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-header\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Messages\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"conversations-list\",children:[conversations.map(conv=>/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-item \".concat(conv.user._id===userId?'active':''),onClick:()=>navigate(\"/messages/\".concat(conv.user._id)),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-avatar\",children:[/*#__PURE__*/_jsx(\"img\",{src:conv.user.avatar,alt:conv.user.name}),isOnline(conv.user._id)&&/*#__PURE__*/_jsx(\"span\",{className:\"online-dot\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"conversation-name\",children:conv.user.name}),/*#__PURE__*/_jsx(\"span\",{className:\"conversation-time\",children:formatMessageTime(conv.lastMessage.createdAt)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-preview\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"last-message\",children:[conv.lastMessage.sender._id===user._id?'You: ':'',conv.lastMessage.content]}),conv.unreadCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"unread-badge\",children:conv.unreadCount})]})]})]},conv.user._id)),conversations.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"no-conversations\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"No conversations yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"no-conversations-sub\",children:\"Go to the dashboard to connect with other creators\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-area \".concat(!userId?'hidden-mobile':''),children:selectedUser?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:()=>navigate('/messages'),children:/*#__PURE__*/_jsx(FiArrowLeft,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-user-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:selectedUser.avatar,alt:selectedUser.name,className:\"chat-avatar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-user-details\",children:[/*#__PURE__*/_jsx(\"h3\",{children:selectedUser.name}),/*#__PURE__*/_jsx(\"span\",{className:\"user-status \".concat(isOnline(selectedUser._id)?'online':''),children:isOnline(selectedUser._id)?'Online':'Offline'})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"header-action\",children:/*#__PURE__*/_jsx(FiMoreVertical,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"messages-list\",children:[messages.map((msg,index)=>{var _messages;const isOwnMessage=msg.sender._id===user._id;const showAvatar=index===0||((_messages=messages[index-1])===null||_messages===void 0?void 0:_messages.sender._id)!==msg.sender._id;return/*#__PURE__*/_jsxs(\"div\",{className:\"message-wrapper \".concat(isOwnMessage?'own':''),children:[!isOwnMessage&&showAvatar&&/*#__PURE__*/_jsx(\"img\",{src:msg.sender.avatar,alt:msg.sender.name,className:\"message-avatar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-bubble \".concat(isOwnMessage?'own':''),children:[/*#__PURE__*/_jsx(\"p\",{className:\"message-content\",children:msg.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"message-time\",children:format(new Date(msg.createdAt),'hh:mm a')}),isOwnMessage&&/*#__PURE__*/_jsx(\"span\",{className:\"message-status\",children:/*#__PURE__*/_jsx(FiCheck,{})})]})]})]},msg._id);}),typingUser&&/*#__PURE__*/_jsxs(\"div\",{className:\"typing-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendMessage,className:\"message-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),onKeyUp:handleTyping,placeholder:\"Type a message...\",className:\"message-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"send-button\",disabled:!newMessage.trim(),children:/*#__PURE__*/_jsx(FiSend,{})})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"no-chat-selected\",children:[/*#__PURE__*/_jsx(FiMessageCircle,{className:\"no-chat-icon\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Your Messages\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select a conversation to start chatting\"})]})})]});};export default Messages;","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useNavigate","useAuth","useSocket","api","FiSend","FiArrowLeft","FiMoreVertical","FiUser","FiCheck","FiMessageCircle","format","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Messages","userId","navigate","user","sendMessage","joinConversation","isOnline","startTyping","stopTyping","conversations","setConversations","messages","setMessages","newMessage","setNewMessage","selectedUser","setSelectedUser","loading","setLoading","typingUser","setTypingUser","messagesEndRef","typingTimeoutRef","fetchConversations","fetchConversation","scrollToBottom","response","get","data","error","otherUserId","concat","length","otherUser","sender","_id","receiver","userResponse","handleSendMessage","e","preventDefault","trim","handleTyping","current","clearTimeout","setTimeout","_messagesEndRef$curre","scrollIntoView","behavior","formatMessageTime","timestamp","date","Date","now","diffInDays","Math","floor","className","children","map","conv","onClick","src","avatar","alt","name","lastMessage","createdAt","content","unreadCount","msg","index","_messages","isOwnMessage","showAvatar","ref","onSubmit","type","value","onChange","target","onKeyUp","placeholder","disabled"],"sources":["C:/Users/satya/OneDrive/Desktop/creatorconnect-backend/frontend/src/pages/Messages.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useSocket } from '../context/SocketContext';\r\nimport api from '../config/api';\r\nimport { FiSend, FiArrowLeft, FiMoreVertical, FiUser, FiCheck, FiMessageCircle } from 'react-icons/fi';\r\nimport { format } from 'date-fns';\r\nimport toast from 'react-hot-toast';\r\nimport './Messages.css';\r\n\r\nconst Messages = () => {\r\n  const { userId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { sendMessage, joinConversation, isOnline, startTyping, stopTyping } = useSocket();\r\n  const [conversations, setConversations] = useState([]);\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [typingUser, setTypingUser] = useState(null);\r\n  const messagesEndRef = useRef(null);\r\n  const typingTimeoutRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    fetchConversations();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (userId) {\r\n      fetchConversation(userId);\r\n      joinConversation(userId);\r\n    }\r\n  }, [userId]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const fetchConversations = async () => {\r\n    try {\r\n      const response = await api.get('/messages/conversations');\r\n      setConversations(response.data);\r\n    } catch (error) {\r\n      toast.error('Failed to load conversations');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchConversation = async (otherUserId) => {\r\n    try {\r\n      const response = await api.get(`/messages/${otherUserId}`);\r\n      setMessages(response.data);\r\n      \r\n      // Find and set selected user\r\n      if (response.data.length > 0) {\r\n        const otherUser = response.data[0].sender._id === user._id\r\n          ? response.data[0].receiver\r\n          : response.data[0].sender;\r\n        setSelectedUser(otherUser);\r\n      } else {\r\n        // If no messages yet, fetch user details\r\n        const userResponse = await api.get(`/users/${otherUserId}`);\r\n        setSelectedUser(userResponse.data);\r\n      }\r\n    } catch (error) {\r\n      toast.error('Failed to load conversation');\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = (e) => {\r\n    e.preventDefault();\r\n    if (!newMessage.trim() || !selectedUser) return;\r\n\r\n    sendMessage(selectedUser._id, newMessage);\r\n    setNewMessage('');\r\n    stopTyping(selectedUser._id);\r\n  };\r\n\r\n  const handleTyping = () => {\r\n    if (!selectedUser) return;\r\n\r\n    startTyping(selectedUser._id);\r\n\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n\r\n    typingTimeoutRef.current = setTimeout(() => {\r\n      stopTyping(selectedUser._id);\r\n    }, 1000);\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const formatMessageTime = (timestamp) => {\r\n    const date = new Date(timestamp);\r\n    const now = new Date();\r\n    const diffInDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));\r\n\r\n    if (diffInDays === 0) {\r\n      return format(date, 'hh:mm a');\r\n    } else if (diffInDays === 1) {\r\n      return 'Yesterday';\r\n    } else if (diffInDays < 7) {\r\n      return format(date, 'EEEE');\r\n    } else {\r\n      return format(date, 'MMM d, yyyy');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"loading-container\">\r\n        <div className=\"loading-spinner\"></div>\r\n        <p>Loading messages...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"messages-container\">\r\n      {/* Conversations Sidebar */}\r\n      <div className={`conversations-sidebar ${userId ? 'hidden-mobile' : ''}`}>\r\n        <div className=\"sidebar-header\">\r\n          <h2>Messages</h2>\r\n        </div>\r\n        <div className=\"conversations-list\">\r\n          {conversations.map((conv) => (\r\n            <div\r\n              key={conv.user._id}\r\n              className={`conversation-item ${conv.user._id === userId ? 'active' : ''}`}\r\n              onClick={() => navigate(`/messages/${conv.user._id}`)}\r\n            >\r\n              <div className=\"conversation-avatar\">\r\n                <img src={conv.user.avatar} alt={conv.user.name} />\r\n                {isOnline(conv.user._id) && <span className=\"online-dot\"></span>}\r\n              </div>\r\n              <div className=\"conversation-info\">\r\n                <div className=\"conversation-header\">\r\n                  <h3 className=\"conversation-name\">{conv.user.name}</h3>\r\n                  <span className=\"conversation-time\">\r\n                    {formatMessageTime(conv.lastMessage.createdAt)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"conversation-preview\">\r\n                  <p className=\"last-message\">\r\n                    {conv.lastMessage.sender._id === user._id ? 'You: ' : ''}\r\n                    {conv.lastMessage.content}\r\n                  </p>\r\n                  {conv.unreadCount > 0 && (\r\n                    <span className=\"unread-badge\">{conv.unreadCount}</span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n\r\n          {conversations.length === 0 && (\r\n            <div className=\"no-conversations\">\r\n              <p>No conversations yet</p>\r\n              <p className=\"no-conversations-sub\">\r\n                Go to the dashboard to connect with other creators\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Chat Area */}\r\n      <div className={`chat-area ${!userId ? 'hidden-mobile' : ''}`}>\r\n        {selectedUser ? (\r\n          <>\r\n            <div className=\"chat-header\">\r\n              <button\r\n                className=\"back-button\"\r\n                onClick={() => navigate('/messages')}\r\n              >\r\n                <FiArrowLeft />\r\n              </button>\r\n              <div className=\"chat-user-info\">\r\n                <img\r\n                  src={selectedUser.avatar}\r\n                  alt={selectedUser.name}\r\n                  className=\"chat-avatar\"\r\n                />\r\n                <div className=\"chat-user-details\">\r\n                  <h3>{selectedUser.name}</h3>\r\n                  <span className={`user-status ${isOnline(selectedUser._id) ? 'online' : ''}`}>\r\n                    {isOnline(selectedUser._id) ? 'Online' : 'Offline'}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n              <button className=\"header-action\">\r\n                <FiMoreVertical />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"messages-list\">\r\n              {messages.map((msg, index) => {\r\n                const isOwnMessage = msg.sender._id === user._id;\r\n                const showAvatar = index === 0 || \r\n                  messages[index - 1]?.sender._id !== msg.sender._id;\r\n\r\n                return (\r\n                  <div\r\n                    key={msg._id}\r\n                    className={`message-wrapper ${isOwnMessage ? 'own' : ''}`}\r\n                  >\r\n                    {!isOwnMessage && showAvatar && (\r\n                      <img\r\n                        src={msg.sender.avatar}\r\n                        alt={msg.sender.name}\r\n                        className=\"message-avatar\"\r\n                      />\r\n                    )}\r\n                    <div className={`message-bubble ${isOwnMessage ? 'own' : ''}`}>\r\n                      <p className=\"message-content\">{msg.content}</p>\r\n                      <div className=\"message-meta\">\r\n                        <span className=\"message-time\">\r\n                          {format(new Date(msg.createdAt), 'hh:mm a')}\r\n                        </span>\r\n                        {isOwnMessage && (\r\n                          <span className=\"message-status\">\r\n                            {/* Using single check for both sent and read */}\r\n                            <FiCheck />\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n              {typingUser && (\r\n                <div className=\"typing-indicator\">\r\n                  <span></span>\r\n                  <span></span>\r\n                  <span></span>\r\n                </div>\r\n              )}\r\n              <div ref={messagesEndRef} />\r\n            </div>\r\n\r\n            <form onSubmit={handleSendMessage} className=\"message-input-container\">\r\n              <input\r\n                type=\"text\"\r\n                value={newMessage}\r\n                onChange={(e) => setNewMessage(e.target.value)}\r\n                onKeyUp={handleTyping}\r\n                placeholder=\"Type a message...\"\r\n                className=\"message-input\"\r\n              />\r\n              <button\r\n                type=\"submit\"\r\n                className=\"send-button\"\r\n                disabled={!newMessage.trim()}\r\n              >\r\n                <FiSend />\r\n              </button>\r\n            </form>\r\n          </>\r\n        ) : (\r\n          <div className=\"no-chat-selected\">\r\n            <FiMessageCircle className=\"no-chat-icon\" />\r\n            <h3>Your Messages</h3>\r\n            <p>Select a conversation to start chatting</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Messages;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}